[build]
builder = "DOCKERFILE"

[[services]]
name = "novascore-backend"
dockerfilePath = "apps/backend/Dockerfile"
buildContext = "."

[services.deploy]
healthcheckPath = "/health"
healthcheckTimeout = 30
startCommand = "sh -c 'node_modules/.bin/prisma migrate deploy && node dist/src/main'"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "novascore-web"
dockerfilePath = "apps/web/Dockerfile"
buildContext = "."

[services.deploy]
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
